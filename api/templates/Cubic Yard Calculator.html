{% extends "base.html" %}

{% block title %}Cubic Yard Calculator{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="bg-white rounded-xl shadow-md overflow-hidden p-6 mb-8">
        <h2 class="text-2xl font-bold text-dark mb-6">Cubic Yard Calculator</h2>
        
        <div x-data="calculator()" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label for="length" class="block text-sm font-medium text-gray-700 mb-1">Length (ft)</label>
                    <input x-model="length" type="number" id="length" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="0.00">
                </div>
                <div>
                    <label for="width" class="block text-sm font-medium text-gray-700 mb-1">Width (ft)</label>
                    <input x-model="width" type="number" id="width" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary" placeholder="0.00">
                </div>
                <div class="flex flex-col">
                    <label for="depth" class="block text-sm font-medium text-gray-700 mb-1">Depth</label>
                    <div class="flex">
                        <input x-model="depth" type="number" id="depth" class="flex-1 px-4 py-2 border border-gray-300 rounded-l-md focus:ring-primary focus:border-primary" placeholder="0.00">
                        <select x-model="unit" class="border border-l-0 border-gray-300 rounded-r-md bg-gray-50 px-2 focus:ring-primary focus:border-primary">
                            <option value="feet">ft</option>
                            <option value="inches">in</option>
                        </select>
                    </div>
                </div>
            </div>

            <button @click="calculate()" class="w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-md transition duration-200">
                Calculate Cubic Yards
            </button>

            <div x-show="result !== null" x-transition class="bg-green-50 border border-green-200 rounded-md p-4">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-lg font-medium text-green-800">Result</h3>
                        <div class="mt-1 text-green-700">
                            <p>You need <span class="font-bold" x-text="result"></span> cubic yards of material.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div x-show="error" x-transition class="bg-red-50 border border-red-200 rounded-md p-4">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-lg font-medium text-red-800">Error</h3>
                        <div class="mt-1 text-red-700">
                            <p x-text="error"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-xl shadow-md overflow-hidden p-6">
        <h3 class="text-xl font-semibold text-dark mb-4">How to Calculate Cubic Yards</h3>
        <p class="text-gray-600 mb-4">To calculate cubic yards, follow these steps:</p>
        <ol class="list-decimal list-inside space-y-2 text-gray-600">
            <li>Measure the length, width, and depth of the area in feet.</li>
            <li>Multiply the three dimensions together (length × width × depth).</li>
            <li>Divide the result by 27 to convert to cubic yards.</li>
        </ol>
        <p class="mt-4 text-gray-600">Formula: (Length (ft) × Width (ft) × Depth (ft)) ÷ 27 = Cubic Yards</p>
    </div>
</div>

<script>
    function calculator() {
        return {
            length: null,
            width: null,
            depth: null,
            unit: 'feet',
            result: null,
            error: null,
            
            calculate() {
                this.error = null;
                this.result = null;
                
                if (!this.length || !this.width || !this.depth) {
                    this.error = 'Please fill in all fields';
                    return;
                }
                
                if (this.length <= 0 || this.width <= 0 || this.depth <= 0) {
                    this.error = 'All values must be greater than zero';
                    return;
                }
                
                fetch('/calculate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        length: this.length,
                        width: this.width,
                        depth: this.depth,
                        unit: this.unit
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        this.result = data.result;
                    } else {
                        this.error = data.error || 'An error occurred during calculation';
                    }
                })
                .catch(error => {
                    this.error = 'Network error. Please try again.';
                });
            }
        }
    }
</script>
{% endblock %}